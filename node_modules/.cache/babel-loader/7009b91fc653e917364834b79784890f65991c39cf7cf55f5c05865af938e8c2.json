{"ast":null,"code":"var _jsxFileName = \"/Users/eva/Documents/pantheonlabQ1/my-app/src/ScenePlayer.jsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst scenes = [{\n  index: 0,\n  sentence: \"This is a simple Javascript test\",\n  textPosition: {\n    x: 320,\n    y: 180\n  },\n  // Center for canvas of 640x360\n  textAnimation: \"typing\",\n  media: \"https://miro.medium.com/max/1024/1*OK8xc3Ic6EGYg2k6BeGabg.jpeg\",\n  // Image URL\n  duration: 5 // Scene 0 duration\n}, {\n  index: 1,\n  sentence: \"Here comes the video!\",\n  textPosition: {\n    x: 320,\n    y: 180\n  },\n  // Center for canvas of 640x360\n  textAnimation: \"blink\",\n  media: \"/VID.mp4\",\n  // Ensure your video is in the public folder\n  duration: 3 // Scene 1 duration\n}];\nconst ScenePlayer = () => {\n  _s();\n  const canvasRef = useRef(null);\n  const videoRef1 = useRef(null);\n  const videoRef2 = useRef(null);\n  const [currentSceneIndex, setCurrentSceneIndex] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n  useEffect(() => {\n    videoRef1.current = document.createElement('video');\n    videoRef1.current.src = scenes[0].media; // 第一个场景的视频或图像\n    videoRef2.current = document.createElement('video');\n    videoRef2.current.src = scenes[1].media; // 第二个场景的视频\n\n    // 加载第一个视频\n    videoRef1.current.load();\n  }, []);\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d');\n    const drawVideo = () => {\n      if (isPlaying) {\n        context.clearRect(0, 0, canvas.width, canvas.height); // 清空画布\n        //const currentVideo = currentSceneIndex === 0 ? videoRef1.current : videoRef2.current;\n        //context.drawImage(currentVideo, 0, 0, canvas.width, canvas.height);\n        context.drawImage(currentSceneIndex === 0 ? videoRef1.current : videoRef2.current, 0, 0, canvas.width, canvas.height);\n\n        // 绘制文本\n        const currentScene = scenes[currentSceneIndex];\n        context.fillStyle = 'white';\n        context.font = '24px Arial';\n        //context.fillText(currentScene.sentence, currentScene.textPosition.x, currentScene.textPosition.y);\n        //requestAnimationFrame(drawVideo);\n        // 根据动画效果绘制文本\n        if (currentScene.textAnimation === \"blink\") {\n          const blink = Math.floor(Date.now() / 500) % 2 === 0; // 每500ms闪烁一次\n          if (blink) {\n            context.fillText(currentScene.sentence, currentScene.textPosition.x, currentScene.textPosition.y);\n          }\n        } else {\n          context.fillText(currentScene.sentence, currentScene.textPosition.x, currentScene.textPosition.y);\n        }\n        requestAnimationFrame(drawVideo);\n      }\n    };\n    const handleClick = () => {\n      if (isPlaying) {\n        pauseVideo();\n      } else {\n        playVideo();\n      }\n    };\n    const handleDoubleClick = () => {\n      stopVideo();\n    };\n    canvas.addEventListener('click', handleClick);\n    canvas.addEventListener('dblclick', handleDoubleClick);\n    return () => {\n      canvas.removeEventListener('click', handleClick);\n      canvas.removeEventListener('dblclick', handleDoubleClick);\n    };\n  }, [currentSceneIndex, isPlaying]);\n  const playVideo = () => {\n    setIsPlaying(true);\n    const currentVideo = currentSceneIndex === 0 ? videoRef1.current : videoRef2.current;\n    currentVideo.play();\n    drawVideo();\n  };\n  const pauseVideo = () => {\n    setIsPlaying(false);\n    const currentVideo = currentSceneIndex === 0 ? videoRef1.current : videoRef2.current;\n    currentVideo.pause();\n  };\n  const stopVideo = () => {\n    setIsPlaying(false);\n    const currentVideo = currentSceneIndex === 0 ? videoRef1.current : videoRef2.current;\n    currentVideo.pause();\n    currentVideo.currentTime = 0; // 重置到开头\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d');\n    context.clearRect(0, 0, canvas.width, canvas.height); // 清空画布\n  };\n  useEffect(() => {\n    const handleVideoEnd = () => {\n      setCurrentSceneIndex(prevIndex => (prevIndex + 1) % scenes.length);\n      playVideo();\n    };\n    videoRef1.current.addEventListener('ended', handleVideoEnd);\n    videoRef2.current.addEventListener('ended', handleVideoEnd);\n    return () => {\n      videoRef1.current.removeEventListener('ended', handleVideoEnd);\n      videoRef2.current.removeEventListener('ended', handleVideoEnd);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      width: \"640\",\n      height: \"360\",\n      style: {\n        border: '1px solid black',\n        cursor: 'pointer'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 9\n  }, this);\n};\n_s(ScenePlayer, \"Y/m0BvNPJki3XPvKVgGilyjzxz4=\");\n_c = ScenePlayer;\nexport default ScenePlayer;\nvar _c;\n$RefreshReg$(_c, \"ScenePlayer\");","map":{"version":3,"names":["React","useRef","useState","useEffect","jsxDEV","_jsxDEV","scenes","index","sentence","textPosition","x","y","textAnimation","media","duration","ScenePlayer","_s","canvasRef","videoRef1","videoRef2","currentSceneIndex","setCurrentSceneIndex","isPlaying","setIsPlaying","current","document","createElement","src","load","canvas","context","getContext","drawVideo","clearRect","width","height","drawImage","currentScene","fillStyle","font","blink","Math","floor","Date","now","fillText","requestAnimationFrame","handleClick","pauseVideo","playVideo","handleDoubleClick","stopVideo","addEventListener","removeEventListener","currentVideo","play","pause","currentTime","handleVideoEnd","prevIndex","length","children","ref","style","border","cursor","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/eva/Documents/pantheonlabQ1/my-app/src/ScenePlayer.jsx"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\n\nconst scenes = [\n    {\n        index: 0,\n        sentence: \"This is a simple Javascript test\",\n        textPosition: { x: 320, y: 180 }, // Center for canvas of 640x360\n        textAnimation: \"typing\",\n        media: \"https://miro.medium.com/max/1024/1*OK8xc3Ic6EGYg2k6BeGabg.jpeg\", // Image URL\n        duration: 5, // Scene 0 duration\n    },\n    {\n        index: 1,\n        sentence: \"Here comes the video!\",\n        textPosition: { x: 320, y: 180 }, // Center for canvas of 640x360\n        textAnimation: \"blink\",\n        media: \"/VID.mp4\", // Ensure your video is in the public folder\n        duration: 3, // Scene 1 duration\n    },\n];\n\nconst ScenePlayer = () => {\n    const canvasRef = useRef(null);\n    const videoRef1 = useRef(null);\n    const videoRef2 = useRef(null);\n    const [currentSceneIndex, setCurrentSceneIndex] = useState(0);\n    const [isPlaying, setIsPlaying] = useState(false);\n\n    useEffect(() => {\n        videoRef1.current = document.createElement('video');\n        videoRef1.current.src = scenes[0].media; // 第一个场景的视频或图像\n        videoRef2.current = document.createElement('video');\n        videoRef2.current.src = scenes[1].media; // 第二个场景的视频\n\n        // 加载第一个视频\n        videoRef1.current.load();\n    }, []);\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        const context = canvas.getContext('2d');\n\n        const drawVideo = () => {\n            if (isPlaying) {\n                context.clearRect(0, 0, canvas.width, canvas.height); // 清空画布\n                //const currentVideo = currentSceneIndex === 0 ? videoRef1.current : videoRef2.current;\n                //context.drawImage(currentVideo, 0, 0, canvas.width, canvas.height);\n                context.drawImage(currentSceneIndex === 0 ? videoRef1.current : videoRef2.current, 0, 0, canvas.width, canvas.height);\n                \n                // 绘制文本\n                const currentScene = scenes[currentSceneIndex];\n                context.fillStyle = 'white';\n                context.font = '24px Arial';\n                //context.fillText(currentScene.sentence, currentScene.textPosition.x, currentScene.textPosition.y);\n                //requestAnimationFrame(drawVideo);\n                // 根据动画效果绘制文本\n                if (currentScene.textAnimation === \"blink\") {\n                    const blink = Math.floor(Date.now() / 500) % 2 === 0; // 每500ms闪烁一次\n                    if (blink) {\n                        context.fillText(currentScene.sentence, currentScene.textPosition.x, currentScene.textPosition.y);\n                    }\n                } else {\n                        context.fillText(currentScene.sentence, currentScene.textPosition.x, currentScene.textPosition.y);\n                }\n\n                requestAnimationFrame(drawVideo);\n            \n            }\n        };\n\n        const handleClick = () => {\n            if (isPlaying) {\n                pauseVideo();\n            } else {\n                playVideo();\n            }\n        };\n\n        const handleDoubleClick = () => {\n            stopVideo();\n        };\n\n        canvas.addEventListener('click', handleClick);\n        canvas.addEventListener('dblclick', handleDoubleClick);\n\n        return () => {\n            canvas.removeEventListener('click', handleClick);\n            canvas.removeEventListener('dblclick', handleDoubleClick);\n        };\n    }, [currentSceneIndex, isPlaying]);\n\n    const playVideo = () => {\n        setIsPlaying(true);\n        const currentVideo = currentSceneIndex === 0 ? videoRef1.current : videoRef2.current;\n        currentVideo.play();\n        drawVideo();\n    };\n\n    const pauseVideo = () => {\n        setIsPlaying(false);\n        const currentVideo = currentSceneIndex === 0 ? videoRef1.current : videoRef2.current;\n        currentVideo.pause();\n    };\n\n    const stopVideo = () => {\n        setIsPlaying(false);\n        const currentVideo = currentSceneIndex === 0 ? videoRef1.current : videoRef2.current;\n        currentVideo.pause();\n        currentVideo.currentTime = 0; // 重置到开头\n        const canvas = canvasRef.current;\n        const context = canvas.getContext('2d');\n        context.clearRect(0, 0, canvas.width, canvas.height); // 清空画布\n    };\n\n    useEffect(() => {\n        const handleVideoEnd = () => {\n            setCurrentSceneIndex((prevIndex) => (prevIndex + 1) % scenes.length);\n            playVideo();\n        };\n\n        videoRef1.current.addEventListener('ended', handleVideoEnd);\n        videoRef2.current.addEventListener('ended', handleVideoEnd);\n\n        return () => {\n            videoRef1.current.removeEventListener('ended', handleVideoEnd);\n            videoRef2.current.removeEventListener('ended', handleVideoEnd);\n        };\n    }, []);\n\n    return (\n        <div>\n            <canvas ref={canvasRef} width=\"640\" height=\"360\" style={{ border: '1px solid black', cursor: 'pointer' }} />\n        </div>\n    );\n};\nexport default ScenePlayer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}